#<center>ODE中间点解法-数值实验报告</center>
<center>数据科学与计算机学院（软件工程） 郑卓民 18342138</center>

## 实验内容：
给定常微分方程(ODE)，求解某处对应的原方程解。一阶常微分方程形式如下：           
$\left\{\begin{array}{l}{\frac{d y}{d x}=f(x, y)} \\ {y\left(x_{0}\right)=y_{0}}\end{array}\right.$

## 实验原理：
1. 对于一阶方程初值问题的数值解法。它是寻求解曲线y(x)在一系列离散节点上的准确值的近似值。
2. 初值问题的数值解法有个基本特点，他们都是采用“步进式”，即求解过程顺着节点排列的次序一步一步地向前推进。也即是：只要给出已知信息前n个点的取值，就能计算出第n+1个点的取值（首先计算递推公式，后代入数值。）
3. ODE的典型解法有欧拉方法、休恩方法、中间点方法(RK2)和龙格库塔方法。

## 实验过程：
> 本实验主要讨论中间点方法。

首先我们可知道，中间点方法的数值计算通式为：      

- $y_{i+1 / 2}=y_{i}+f\left(t_{i}, y_{i}\right) \frac{h}{2}$
- $y_{i+1 / 2}^{\prime}=f\left(t_{i+1 / 2}, y_{i+1 / 2}\right)$
- $y_{i+1}=y_{i}+f\left(t_{i+1 / 2}, y_{i+1 / 2}\right) h$


我们不妨利用一个实例来更好地理解中间点方法：

> 对于ODE为 $y^{\prime}=t^{2}-y$，初值为 $y(0) = 1$，分别以步长为 $h = 0.1$和 $h = 0.2$，并用中间点方法求解 $y(0.4)$，得到递推值后与真实值比较，算得误差。（其中原方程为：$y(t)=-e^{-t}+t^{2}-2 t+2$ ）

#### 首先对$h = 0.2$的情况进行求解：

$y_{0}=y_{(0)}=1$

$y_{0+\frac{1}{2}}=y(0.1)=y_{0}+f\left(t_{0}, y_{0}\right) \frac{h}{2}=1+(0-1) \times 0.1=0.9$

$y_{1}=y(0.2)=y(0)+f\left(t_{\frac{1}{2}}, y_{\frac{1}{2}}\right) \cdot h=1+\left(0.01-0.9\right) \cdot 0.2=0.8220$

$y_{1+\frac{1}{2}}=y(0.3)=y_{1}+f\left(t_{1}, y_{1}\right) \frac{h}{2}=0.822+(0.04-0.822) \times 0.1=0.7438$

$y_{2}=y(0.4)=y(1)+f\left(t_{\frac{3}{2}}, y_{\frac{3}{2}}\right) \cdot h=0.822+\left(0.09-0.7438\right) \cdot 0.2=0.6912$

对于$y(0.4)$的真实值：

$y(0.4)=-e^{-0,4}+(0.4)^{2}-2 \times 0.4+2=0.689679954$

计算误差得：

$E=\left|y_{M}-y_{2}\right|=|0.6912-0.6897|=0.0015$

结合作业中使用欧拉方法算得的结果误差（$E = 0.0202$），中间点方法的误差小了很多。

#### 对$h = 0.1$的情况进行求解：

$y_{0}=y_{(0)}=1$

$y_{0+\frac{1}{2}}=y(0.05)=y_{0}+f\left(t_{0}, y_{0}\right) \frac{h}{2}=1+(0-1) \times 0.05=0.9500$

$y_{1}=y(0.1)=y_{0}+f\left(t_{\frac{1}{2}}, y_{\frac{1}{2}}\right) \cdot h=1+\left(0.05^2-0.9500\right) \cdot 0.1=0.9052$

$y_{1+\frac{1}{2}}=y(0.15)=y_{1}+f\left(t_{1}, y_{1}\right) \frac{h}{2}=0.9052+(0.1^2-0.9052) \times 0.05=0.86044$

$y_{2}=y(0.2)=y_{1}+f\left(t_{\frac{3}{2}}, y_{\frac{3}{2}}\right) \cdot h=0.9052+\left(0.15^2-0.86044\right) \cdot 0.1=0.821406$

$y_{2+\frac{1}{2}}=y(0.25)=y_{2}+f\left(t_{2}, y_{2}\right) \frac{h}{2}=0.821406+(0.2^2-0.821406) \times 0.05=0.7823357$

$y_{3}=y(0.3)=y_{2}+f\left(t_{\frac{5}{2}}, y_{\frac{5}{2}}\right) \cdot h=0.821406+\left(0.25^2-0.7823357\right) \cdot 0.1=0.74942243$

$y_{3+\frac{1}{2}}=y(0.35)=y_{3}+f\left(t_{3}, y_{3}\right) \frac{h}{2}=0.74942243+(0.3^2-0.74942243) \times 0.05=0.7164513085$

$y_{4}=y(0.4)=y_{3}+f\left(t_{\frac{7}{2}}, y_{\frac{7}{2}}\right) \cdot h=0.74942243+\left(0.35^2-0.7164513085\right) \cdot 0.1=0.69002729915$

计算误差得：

$E=\left|y_{M}-y_{4}\right|=|0.69002729915-0.689679954|=3.4734515 E-04$

结合作业中使用欧拉方法算得的结果误差（$E = 0.04168$），中间点方法的误差同样小了更多。

## 实验总结：

通过本次数值实验，对ODE的数值计算有了更深的理解，所有的计算解法都可归结为采用“步进式”的一个递推通式，随着阶数的提高，或者计算步长的缩短，预测同样点的计算次数相应会增加，相应的递推结果也更加贴近真实值。

